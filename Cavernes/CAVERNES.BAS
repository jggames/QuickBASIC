REM Jim Gerrie 2024: Quick Basic "Cavernes in my Pocket" by Charles Feydy (1982)
REM From MC-10 source,which was from TRS-80 Pocket PC
CLS
DIM msg$(68)
DIM A(69) AS DOUBLE

FOR CC = 22 TO 65: READ msg$(CC): NEXT CC

10 CLS : INPUT "DUNGEON NO."; A(4): INPUT "LEVEL (0-5)"; CC: A(6) = 4 * CC

20 FOR G = 13 TO 21: A(5) = A(4) + 15 * G: GOSUB 290: A(G) = INT(A(5)): NEXT G
30 A(3) = 5: A(67) = 0: GOSUB 180: GOTO 100

35 msg$(66) = "": IF A(3) > 100 THEN A(3) = A(3) - 100 * INT(A(3) / 100)
40 G = A(2) - INT(A(2)): A(7) = G: FOR H = 1 TO 3: A(8) = H: G = G * 10: A(8 + H) = INT(G) + 7 + (H + 1) * 10: G = G - INT(G): A(7) = G: NEXT H: A(8) = H
50 PRINT "YOU ARE IN A"; : CC = ASC(msg$(A(9))): IF CC = 65 OR CC = 69 OR CC = 73 OR CC = 79 OR CC = 85 THEN PRINT "N";
51 PRINT " "; msg$(A(9)); " "; msg$(A(10)); " "; msg$(A(11))
60 IF INT(A(1)) > 40 - A(6) THEN G = INT(57 + INT(A(2)) / 20): PRINT "THERE IS A "; msg$(G): msg$(66) = msg$(G)
70 FOR G = 1 TO 10: A(7) = G: IF A(11 + G) = A(3) THEN PRINT "YOU FIND RING #"; G
75 NEXT G: A(7) = G: PRINT "EXITS:"
80 FOR G = 1 TO 7 STEP 2: A(11) = G: GOSUB 280
81 IF A(11) >= 4 THEN A(11) = G + 1: A(10) = A(11) / 2 + 61: GOSUB 280: A(11) = 22 + INT(A(11) / 2): PRINT "A "; msg$(A(11)); " IS "; msg$(A(10))
90 NEXT G: A(7) = G: RETURN

100 PRINT : INPUT "ORDER"; M$: M$ = LEFT$(M$, 1)
120 IF M$ = "N" THEN A(11) = 1: GOTO 160
130 IF M$ = "E" THEN A(11) = 3: GOTO 160
140 IF M$ = "S" THEN A(11) = 5: GOTO 160
150 IF M$ = "W" THEN A(11) = 7: GOTO 160
151 IF M$ = "G" THEN 190
152 IF M$ = "I" THEN 210
153 IF M$ = "Q" THEN 300
154 IF M$ = "L" THEN 400
155 IF M$ = "K" THEN 230
156 IF M$ = "R" THEN RUN
157 IF M$ = "=" THEN PRINT "SCORE:"; A(67)
159 GOTO 100

160 G = A(11): A(68) = A(11): GOSUB 280: IF A(11) < 4 THEN 270
170 A(11) = G + 1: GOSUB 280: IF A(11) / 2 - INT(A(11) / 2) <> 0 THEN IF INT(A(1)) > 40 - A(6) THEN PRINT "THE MONSTER STOPS YOU": GOTO 100
180 FOR G = 1 TO 2: A(3) = A(3) - 4 + A(68): A(5) = A(3) + A(4): GOSUB 290: A(G) = A(5): NEXT G: GOSUB 35: GOTO 100

REM "H" (G)ET
190 FOR G = 12 TO 21: IF A(G) = A(3) THEN PRINT "OK.": A(G) = 0
200 NEXT G: GOTO 100

REM "J" (I)NVENTORY
210 A(9) = 0: PRINT "YOU HAVE": FOR G = 12 TO 21: IF A(G) = 0 THEN A(8) = G - 11: PRINT "RING #"; A(8): A(9) = 1
220 NEXT G: IF A(9) = 0 THEN PRINT "NOTHING"
225 GOTO 100

REM "K" (K)ILL
230 IF msg$(66) = "" THEN 100
240 G = INT(A(2)) - 10 * INT(A(2) / 10)

flag = 0
IF A(G + 12) = 0 THEN
        PRINT "OK.": A(67) = 1 + A(67): msg$(66) = ""
        FOR H = 2 TO 8 STEP 2: A(11) = H: A(8) = H: GOSUB 280
        IF A(11) / 2 - INT(A(11) / 2) <> 0 THEN A(1) = A(1) + 1 / 10 ^ H
        NEXT H: A(8) = H: flag = 1
END IF
IF flag = 1 THEN 100

270 A(8) = H: FOR H = 0 TO 1: NEXT H: H = A(8): PRINT "NO!": GOTO 100

280 A(11) = (INT(A(1) * 10 ^ A(11))) - (10 * INT(A(1) * 10 ^ (A(11) - 1))): RETURN

REM "R"
290 A(5) = ABS(SIN(A(5)) * 100): RETURN

REM "L"
300 PRINT "SCORE:"; A(67): END

REM "=" (L)OOK
400 GOSUB 35: GOTO 100

522 DATA DOOR,PATH,ROAD,TUNNEL,HATCH
528 DATA OLD,DIRTY,LONG,SMALL,SOMBER,DARK,STRANGE,LARGE,ANCIENT,WIDE,ROMAN,GREEK,LOST
540 DATA ARID,DAMP,SOMBER,DANK,BROKEN,EVIL,WASHED OUT
547 DATA TUNNEL,TEMPLE,TOMB,VAULT,TAVERN,CORRIDOR,TUNNEL,WELL,PASSAGE,PIT
557 DATA DRAGON,WIZARD,TROLL,LION,VAMPIRE
562 DATA NORTH,EAST,SOUTH,WEST

